!function(e){"use strict";var t=window.angular.module("jim",["ionic","firebase"]);t.constant("paths",{components:"/ui/src/components"}),t.config(function(e,t){e.state("login",{url:"/login",controller:"AuthCtrl",templateUrl:"/ui/src/components/auth/auth.html",auth:!1}),e.state("tabs",{url:"",abstract:!0,templateUrl:"/ui/src/global/tabs.html"}),e.state("tabs.exercise-list",{url:"/exercises",views:{exercises:{controller:"ExerciseListCtrl",templateUrl:"/ui/src/components/exercises/exercise-list.html"}}}),e.state("tabs.exercise",{url:"/exercises/:id",views:{exercises:{controller:"ExerciseCtrl",templateUrl:"/ui/src/components/exercises/exercise.html"}}}),e.state("tabs.workout-list",{url:"/workouts",views:{workouts:{controller:"WorkoutListCtrl",templateUrl:"/ui/src/components/workouts/workout-list.html"}}}),e.state("tabs.workout",{url:"/workouts/:id",views:{workouts:{controller:"WorkoutCtrl",templateUrl:"/ui/src/components/workouts/workout.html"}}}),e.state("tabs.timer",{url:"/stopwatch",views:{stopwatch:{controller:"StopwatchCtrl",templateUrl:"/ui/src/components/stopwatch/stopwatch.html"}}}),e.state("tabs.session",{url:"/sessions/:id",views:{workouts:{controller:"SessionCtrl",templateUrl:"/ui/src/components/sessions/session.html"}}}),t.otherwise("/login")}),t.run(["$state","Mediator","AuthService",function(e,t,s){t.subscribe("$stateChangeStart",function(t,i){!1===i.auth||s.user||(e.transitionTo("login"),t.preventDefault())}),t.subscribe("$firebaseSimpleLogin:login",function(){e.go("tabs.exercise-list")})}])}(),function(e){"use strict";window.angular.module("jim").controller("AuthCtrl",["$scope","AuthService",function(e,t){e.login=function(){t.login()}}])}(),function(e){"use strict";window.angular.module("jim").controller("ExerciseListCtrl",["$scope","$ionicModal","paths","$firebase","DataService",function(e,t,s,i,o){var n=s.components+"/exercises/new-exercise-modal.html";t.fromTemplateUrl(n,function(t){e.modal=t},{scope:e,animation:"slide-in-up"}),e.exercises=i(o.exercises),e.exercise={name:null,sessions:{}},e.createExercise=function(t){o.create("exercises",t),e.modal.hide()}}])}(),function(e){"use strict";window.angular.module("jim").controller("ExerciseCtrl",["$scope","$stateParams","$firebase","DataService",function(e,t,s,i){var o=i.exercises.child(t.id);e.exercise=s(o)}])}(),function(e){"use strict";window.angular.module("jim").controller("SessionCtrl",["$scope","$stateParams","$ionicModal","paths","$firebase","DataService",function(e,t,s,i,o,n){var r=i.components+"/sessions/set-modal.html",c=n.sessions.child(t.id),a=null;e.session=o(c),e.exercises=o(n.exercises),s.fromTemplateUrl(r,function(t){e.modal=t},{scope:e,animation:"slide-in-up"}),e.editSet=function(t){t||(t=c.child("/sets").push({reps:0,weight:0}).name()),(a=c.child("/sets/"+t)).on("value",function(t){e.set=t.val()}),e.modal.show()},e.editDone=function(){c.child("/sets/"+a.name()).set(e.set),e.modal.hide(),e.set=null},e.$on("$destroy",function(){e.modal.remove()})}])}(),function(e){"use strict";window.angular.module("jim").controller("StopwatchCtrl",["$scope","$interval",function(e,t){var s=0;e.stopwatch={running:!1,time:0},t(function(){e.stopwatch.running&&(s=parseFloat(e.stopwatch.time),e.stopwatch.time=(s+=.1).toFixed(1))},100)}])}(),function(e){"use strict";window.angular.module("jim").controller("WorkoutListCtrl",["$scope","$ionicModal","paths","$firebase","TimeService","DataService",function(e,t,s,i,o,n){var r=s.components+"/workouts/new-workout-modal.html";t.fromTemplateUrl(r,function(t){e.modal=t},{scope:e,animation:"slide-in-up"}),e.workouts=i(n.workouts),e.exercises=i(n.exercises),e.workout={date:o.now().toISOString(),sessions:{}},e.createWorkout=function(t){var s=n.create("workouts",t);for(var i in e.exercises)e.exercises[i].selected&&n.create("sessions",{date:o.now().toISOString(),exercise:i,workout:s.name()});e.modal.hide()}}])}(),function(e){"use strict";window.angular.module("jim").controller("WorkoutCtrl",["$scope","$stateParams","$firebase","DataService",function(e,t,s,i){var o=i.workouts.child(t.id);function n(t){e.sessions[t.name()]=t.val()}e.workout=s(o),e.exercises=s(i.exercises),e.sessions={},o.on("value",function(e){for(var t in e.val().sessions)i.sessions.child(t).once("value",n)})}])}(),function(e){"use strict";var t=e.angular,s=e.Firebase,i=t.module("jim"),o=new s("https://amend.firebaseio.com");i.service("AuthService",["$firebaseSimpleLogin","Mediator",function(e,t){var s=this,i=e(o);t.subscribe("$firebaseSimpleLogin:login",function(e,t){s.user=t}),this.login=function(){return i.$login("anonymous")}}]),i.service("DataService",["AuthService",function(e){var t=this,s=o.child(e.user.uid);this.sessions=s.child("/sessions"),this.exercises=s.child("/exercises"),this.workouts=s.child("/workouts"),this.sessions.on("child_added",function(e){var s=e.name(),i=e.val(),o="/sessions/"+s;t.exercises.child(i.exercise+o).set(!0),t.workouts.child(i.workout+o).set(!0)}),this.create=function(e,t){var s=this[e];if(!s)throw new function(e){this.value=e,this.message="No such entity as: ",this.toString=function(){return this.message+this.value}}(e);return s.push(t)}}])}(window),function(e){"use strict";window.angular.module("jim").filter("len",[function(){return function(e){var t,s=0;if(e)for(t in e)e.hasOwnProperty(t)&&(s+=1);return s}}])}(),function(e){"use strict";window.angular.module("jim").service("Mediator",["$rootScope",function(e){this.publish=function(t,s){e.$broadcast(t,s)},this.subscribe=function(t,s){e.$on(t,s)}}])}(),function(e){"use strict";var t=e.moment,s=e.angular.module("jim");t.lang("sv"),s.service("TimeService",[function(){this.local=function(e){return t(e)},this.utc=function(e){return t.utc(e)},this.now=function(){return t()}}]),s.filter("date",["TimeService",function(e){return function(t){if(t)return e.utc(t).format("LLLL")}}])}(window);